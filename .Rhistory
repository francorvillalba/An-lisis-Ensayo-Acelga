agregarFilas<-data.frame( temporada = c("Primavera/Verano", "Primavera/Verano", "Primavera/Verano", "Primavera/Verano", "Primavera/Verano"),
efecto = c(" x̅", "CV", "p-valor", "p-valor", "p-valor"),
nivel =c(" x̅", "CV", "Dosis abono", "Variedad", "Dosis*Variedad"),
TAL1 =c(mean(AreaFoliarE1$TAL1), 23.25, 0.68633, 0.75163, 0.16174),
TAL2 =c(mean(AreaFoliarE1$TAL2), 24.31, 0.66481, 0.73664, 0.03131),
TAL3 =c(mean(AreaFoliarE1$TAL3), 48.32, 0.38469, 0.33795, 0.71395),
TAL4 = c(mean(AreaFoliarE1$TAL4), 64.73, 0.71345, 0.01474, 0.92418),
EE1 = c(NA, NA, NA, NA, NA),
EE2 = c(NA, NA, NA, NA, NA),
EE3 = c(NA, NA, NA, NA, NA),
EE4 = c(NA, NA, NA, NA, NA))
colnames(tabla_ancha)<-colnames(agregarFilas)
tabla_ancha<-rbind(tabla_ancha, agregarFilas)
agregarFilas2<-data.frame( temporada = c("Otoño/Invierno", "Otoño/Invierno", "Otoño/Invierno", "Otoño/Invierno", "Otoño/Invierno"),
efecto = c(" x̅", "CV", "p-valor", "p-valor", "p-valor"),
nivel =c(" x̅", "CV", "Dosis abono", "Variedad", "Dosis*Variedad"),
TAL1 =c(mean(AreaFoliarE2$TAL1), 22.85, 0.10948, 0.70595, 0.99034),
TAL2 =c(mean(AreaFoliarE2$TAL2), 28.93, 0.62713, 0.15221, 0.76208),
TAL3 =c(mean(AreaFoliarE2$TAL3), 134.86, 0.91511, 0.01215, 0.91690),
TAL4 = c(mean(AreaFoliarE1$TAL4), 105.76, 0.55787, 0.01742, 0.97393),
EE1 = c(NA, NA, NA, NA, NA),
EE2 = c(NA, NA, NA, NA, NA),
EE3 = c(NA, NA, NA, NA, NA),
EE4 = c(NA, NA, NA, NA, NA))
colnames(tabla_ancha2)<-colnames(agregarFilas2)
tabla_ancha2<-rbind(tabla_ancha2, agregarFilas2)
tabla_ancha<-rbind(tabla_ancha, tabla_ancha2)
library(flextable)
library(dplyr)
library(officer)
library(tidyverse)
tp<-  flextable(data= tabla_ancha,
col_keys= c("temporada", "efecto", "nivel", "TAL1", "TAL2", "TAL3", "TAL4"),
)%>% compose(i=c(1:6, 12:17),
j= "TAL1",
value= as_paragraph(
as_chunk(format(TAL1, digits=2), props= fp_text(color="black", font.size=8) ),
" ± ",
as_chunk(format(EE1, digits=2), props= fp_text(color="black", italic=TRUE, font.size=8))),
part="body" ) %>%
compose(i=c(1:6, 12:17),
j= "TAL2",
value= as_paragraph(
as_chunk(format(TAL2, digits=2), props= fp_text(color="black", font.size=8)),
" ± ",
as_chunk(format(EE2, digits=2), props= fp_text(color="black", italic=TRUE, font.size=8))),
part="body" )%>%
compose(i=c(1:6, 12:17),
j= "TAL3",
value= as_paragraph(
as_chunk(format(TAL3, digits=2), props= fp_text(color="black", font.size=8)),
" ± ",
as_chunk(format(EE3, digits=2), props= fp_text(color="black", italic=TRUE, font.size=8))),
part="body" ) %>% compose(i=c(1:6, 12:17),
j= "TAL4",
value= as_paragraph(
as_chunk(format(TAL4, digits=2), props= fp_text(color="black", font.size=8)),
" ± ",
as_chunk(format(EE4, digits=2), props= fp_text(color="black", italic=TRUE, font.size = 8))),
part="body" )
tp<-colformat_double(tp, i=c(9:11, 20:22), j= c(4:7), digits= 4)
tp<-colformat_double(tp, i=c(7:8, 18:19), j=4:7, digits=2)
tp<-tp %>% add_header_row(
top= TRUE,
values= c("Temporada",
"Tratamientos",
"",
"Muestreo 1",
"Muestreo 2",
"Muestreo 3",
"Muestreo 4" )) %>% set_header_labels(
temporada= "Temporada",
efecto = "Factor",
nivel= "Nivel",
MS1 = "TAL",
MS2 = "",
MS3 = "",
MS4 = "") %>%
merge_at(i=1, j=2:3, part="header") %>%
merge_at(i=2, j=4:7, part="header")
tp<-compose(tp, i=2, j=4,
value= as_paragraph(
"Tasa de Asimilación Liquida (g cm",
as_sup("-2"),
" día",
as_sup("-1")
")"
),
part="header")
tp<-compose(tp, i=2, j=4,
value= as_paragraph(
"Tasa de Asimilación Liquida (g cm",
as_sup("-2"),
" día",
as_sup("-1"),
")"
),
part="header")
tp<-tp %>% merge_at(i=7, j=2:3, part="body")%>%
merge_at(i=8, j=2:3, part="body")%>%
merge_at(i=18, j=2:3, part="body")%>%
merge_at(i=19, j=2:3, part="body")
tp<- tp %>% merge_at(i=1:11, j=1, part="body") %>%
merge_at(i=12:22, j=1, part="body") %>%
merge_at(i=1:2, j=1, part="header")%>%
merge_v(j=2, part="body")
tp <- tp %>% flextable::align(align="left", part="all")
tp<- tp %>% flextable::align(align="center", i=c(7:8, 18:19), j=2:3, part="body")
tp<-tp %>% fontsize(size = 8, part = "all")%>%
bold( part="header")
tp<-hline(tp, border= fp_border(color="gray", style="solid", width=1), i=c(4, 6, 8, 11, 15, 17, 19, 22), part="body")
tp<-compose(tp, i=c(1,12), j=2,
value= as_paragraph(
as_chunk(efecto), " (g m", as_sup("-2"), ")"
),
part="body")
tp
tp<-colformat_double(tp, i=c(7,18), j=4:7, nsmall=2)
tp<-colformat_double(tp, i=c(7,18), j=4:7, digits=5)
tp
save_as_docx("Tasa de Asimilación Líquida"= tp, path= "Resultados/TasaAsimilacion.docx")
CrecimientoE1<-readRDS(file = "Resultados/CrecimientoE1_v2.rds")
CrecimientoE2<-readRDS(file = "Resultados/CrecimientoE2_v2.rds")
TCRensayo1<-readRDS(file = "Resultados/TCRensayo1.rds")
TCRensayo2<-readRDS(file = "Resultados/TCRensayo2.rds")
TCRensayo1$temporada<-"Primavera/Verano"
TCRensayo2$temporada<-"Otoño/Invierno"
tabla1<-data.frame( "temporada"=TCRensayo1$temporada,
"efecto"= TCRensayo1$factor,
"nivel"= TCRensayo1$nivel,
"fecha"= TCRensayo1$fecha,
"TCR"= TCRensayo1$media,
"EE"=TCRensayo1$EE)
tabla2<-data.frame( "temporada"=TCRensayo2$temporada,
"efecto"= TCRensayo2$factor,
"nivel"= TCRensayo2$nivel,
"fecha"= TCRensayo2$fecha,
"TCR"= TCRensayo2$media,
"EE"=TCRensayo2$EE)
library(tidyverse)
tabla_ancha<-pivot_wider(data=tabla1,
id_cols= c(temporada, efecto, nivel),
names_from= fecha,
values_from=c(TCR, EE))
tabla_ancha2<-pivot_wider(data=tabla2,
id_cols= c(temporada, efecto, nivel),
names_from= fecha,
values_from=c(TCR, EE))
agregarFilas<-data.frame( temporada = c("Primavera/Verano", "Primavera/Verano", "Primavera/Verano", "Primavera/Verano", "Primavera/Verano"),
efecto = c(" x̅", "CV", "p-valor", "p-valor", "p-valor"),
nivel =c(" x̅", "CV", "Dosis abono", "Variedad", "Dosis*Variedad"),
TCR1 =c(mean(CrecimientoE1$TCR1), 54.23, 0.49290, 0.88306, 0.05932),
TCR2 =c(mean(CrecimientoE1$TCR2), 23.81, 0.76019, 0.05921, 0.03073),
TCR3 =c(mean(CrecimientoE1$TCR3), 45.31, 0.37596, 0.35654, 0.83484),
TCR4 = c(mean(CrecimientoE1$TCR4), 62.05, 0.86253, 0.00675, 0.06268),
EE1 = c(NA, NA, NA, NA, NA),
EE2 = c(NA, NA, NA, NA, NA),
EE3 = c(NA, NA, NA, NA, NA),
EE4 = c(NA, NA, NA, NA, NA))
colnames(tabla_ancha)<-colnames(agregarFilas)
tabla_ancha<-rbind(tabla_ancha, agregarFilas)
agregarFilas2<-data.frame( temporada = c("Otoño/Invierno", "Otoño/Invierno", "Otoño/Invierno", "Otoño/Invierno", "Otoño/Invierno"),
efecto = c(" x̅", "CV", "p-valor", "p-valor", "p-valor"),
nivel =c(" x̅", "CV", "Dosis abono", "Variedad", "Dosis*Variedad"),
TCR1 =c(mean(CrecimientoE2$TCR1), 22.59, 0.22121, 0.35825, 0.87807),
TCR2 =c(mean(CrecimientoE2$TCR2), 27.27, 0.5315, 0.20228, 0.77738),
TCR3 =c(mean(CrecimientoE2$TCR3), 136.94, 0.92948, 0.01169, 0.96094),
TCR4 = c(mean(CrecimientoE2$TCR4), 104.36, 0.99325, 0.00874, 0.89632),
EE1 = c(NA, NA, NA, NA, NA),
EE2 = c(NA, NA, NA, NA, NA),
EE3 = c(NA, NA, NA, NA, NA),
EE4 = c(NA, NA, NA, NA, NA))
colnames(tabla_ancha2)<-colnames(agregarFilas2)
tabla_ancha2<-rbind(tabla_ancha2, agregarFilas2)
tabla_ancha<-rbind(tabla_ancha, tabla_ancha2)
library(flextable)
library(dplyr)
library(officer)
tp<-  flextable(data= tabla_ancha,
col_keys= c("temporada", "efecto", "nivel", "TCR1", "TCR2", "TCR3", "TCR4"),
)%>% compose(i=c(1:6, 12:17),
j= "TCR1",
value= as_paragraph(
as_chunk(format(TCR1, digits=2), props= fp_text(color="black", font.size=8) ),
" ± ",
as_chunk(format(EE1, digits=2), props= fp_text(color="black", italic=TRUE, font.size=8))),
part="body" ) %>%
compose(i=c(1:6, 12:17),
j= "TCR2",
value= as_paragraph(
as_chunk(format(TCR2, digits=2), props= fp_text(color="black", font.size=8)),
" ± ",
as_chunk(format(EE2, digits=2), props= fp_text(color="black", italic=TRUE, font.size=8))),
part="body" )%>%
compose(i=c(1:6, 12:17),
j= "TCR3",
value= as_paragraph(
as_chunk(format(TCR3, digits=2), props= fp_text(color="black", font.size=8)),
" ± ",
as_chunk(format(EE3, digits=2), props= fp_text(color="black", italic=TRUE, font.size=8))),
part="body" ) %>% compose(i=c(1:6, 12:17),
j= "TCR4",
value= as_paragraph(
as_chunk(format(TCR4, digits=2), props= fp_text(color="black", font.size=8)),
" ± ",
as_chunk(format(EE4, digits=2), props= fp_text(color="black", italic=TRUE, font.size = 8))),
part="body" )
tp<-colformat_double(tp, i=c(9:11, 20:22), j= c(4:7), digits= 4)
tp<-colformat_double(tp, i=c(7:8, 18:19), j=4:7, digits=2)
tp<-tp %>% add_header_row(
top= TRUE,
values= c("Temporada",
"Tratamientos",
"",
"Muestreo 1",
"Muestreo 2",
"Muestreo 3",
"Muestreo 4" )) %>% set_header_labels(
temporada= "Temporada",
efecto = "Factor",
nivel= "Nivel",
MS1 = "TCR1",
MS2 = "",
MS3 = "",
MS4 = "") %>%
merge_at(i=1, j=2:3, part="header") %>%
merge_at(i=2, j=4:7, part="header")
tp<-compose(tp, i=2, j=4,
value= as_paragraph(
"Tasa de Crecimiento Relativa (g g",
as_sup("-1"),
"día",
as_sup("-1"),
")"
),
part="header")
tp<-tp %>% merge_at(i=7, j=2:3, part="body")%>%
merge_at(i=8, j=2:3, part="body")%>%
merge_at(i=18, j=2:3, part="body")%>%
merge_at(i=19, j=2:3, part="body")
tp
tp<- tp %>% merge_at(i=1:11, j=1, part="body") %>%
merge_at(i=12:22, j=1, part="body") %>%
merge_at(i=1:2, j=1, part="header")%>%
merge_v(j=2, part="body")
tp <- tp %>% flextable::align(align="left", part="all")
tp<- tp %>% flextable::align(align="center", i=c(7:8, 18:19), j=2:3, part="body")
tp<-tp %>% fontsize(size = 8, part = "all")%>%
bold( part="header")
tp<-hline(tp, border= fp_border(color="gray", style="solid", width=1), i=c(4, 6, 8, 11, 15, 17, 19, 22), part="body")
tp<-compose(tp, i=c(1,12), j=2,
value= as_paragraph(
as_chunk(efecto), " (g m", as_sup("-2"), ")"
),
part="body")
tp
save_as_docx("Tasa de Crecimiento Relativa"= tp, path= "Resultados/TasaRelativa.docx")
Nutriente1
Nutriente1<-read.csv("NutrientesE1.csv", sep=",", dec=",", header = TRUE)
View(Nutriente1)
Nutriente2<-read.csv("NutrientesE2.csv", sep=",", dec=",", header = TRUE)
msensayo1<- readRDS("Resultados/msensayo1")
msensayo1<- readRDS("Resultados/msensayo1_v2")
msensayo1<- readRDS("Resultados/msensayo1_v2.rds")
msensayo2<-readRDS("Resultados/msensayo2_v2.rds")
View(msensayo1)
AcuNutrientesE1<-data.frame("Fecha"= msensayo1$fecha,
"Factor"=msensayo1$group,
"Nivel"=msensayo1$nivel,
"MS"=msensayo1$media)
View(AcuNutrientesE1)
f01<-as.Date("24/11/2022", format="%d/%m/%Y")
View(msensayo2)
f02<-as.Date("18/05/2023", format="%d/%m/%Y")
AcuNutrientesE1<-data.frame("Fecha"= msensayo1$fecha[msensayo1$fecha>f01],
"Factor"=msensayo1$group[msensayo1$fecha>f01],
"Nivel"=msensayo1$nivel[msensayo1$fecha>f01],
"MS"=msensayo1$media[msensayo1$fecha>f01])
Nutriente1$Medicion<-trimws(Nutriente1$Medicion)
mean(Nutriente1$N.[Nutriente1$Medicion=="Primera"])
Nutriente1$N.[Nutriente1$Medicion=="Primera"]
Nutriente1$N.[Nutriente1$Medicion=="PRIMERA"]
Nutriente1$N.[Nutriente1$Medicion=="PRIMERA" & Nutriente1$dosis==1]
mean(Nutriente1$N.[Nutriente1$Medicion=="PRIMERA" & Nutriente1$dosis==1])
for (j in dosis)
concNdosis<-c()
mediciones<-c("PRIMERA", "SEGUNDA", "TERCERA", "CUARTA")
dosis<-c(1:4)
variedad<-c(1:2)
concNdosis<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concNdosis<- c(concNdosis, mean(Nutriente1$N.[Nutriente1$Medicion== i &
Nutriente1$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concNdosis<- c(concNdosis, mean(Nutriente1$N.[Nutriente1$Medicion== i &
Nutriente1$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
concNdosis
AcuNutrientesE1$Nx100<-concNdosis
###Lo mismo con Fosforo
concP<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concP<- c(concP, mean(Nutriente1$P.[Nutriente1$Medicion== i &
Nutriente1$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concP<- c(concP, mean(Nutriente1$P.[Nutriente1$Medicion== i &
Nutriente1$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
AcuNutrientesE1$Px100<-concP
##### Ahora el potasio
concK<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concK<- c(concK, mean(Nutriente1$K.[Nutriente1$Medicion== i &
Nutriente1$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concK<- c(concK, mean(Nutriente1$K.[Nutriente1$Medicion== i &
Nutriente1$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
AcuNutrientesE1$Kx100<-concK
#### el Calcio
concCa<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concCa<- c(concCa, mean(Nutriente1$Ca.[Nutriente1$Medicion== i &
Nutriente1$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concCa<- c(concCa, mean(Nutriente1$Ca.[Nutriente1$Medicion== i &
Nutriente1$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
AcuNutrientesE1$Cax100<-concCa
concMg<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concMg<- c(concMg, mean(Nutriente1$Mg.[Nutriente1$Medicion== i &
Nutriente1$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concMg<- c(concMg, mean(Nutriente1$Mg.[Nutriente1$Medicion== i &
Nutriente1$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
AcuNutrientesE1$Mgx100<-concMg
AcuNutrientesE1$Nacu<-AcuNutrientesE1$MS*AcuNutrientesE1$Nx100/100
AcuNutrientesE1$Pacu<-AcuNutrientesE1$MS*AcuNutrientesE1$Px100/100
AcuNutrientesE1$Kacu<-AcuNutrientesE1$MS*AcuNutrientesE1$Kx100/100
AcuNutrientesE1$Caacu<-AcuNutrientesE1$MS*AcuNutrientesE1$Cax100/100
AcuNutrientesE1$Mgacu<-AcuNutrientesE1$MS*AcuNutrientesE1$Mgx100/100
##Guardar esta tabla:
SaveRDS(AcuNutrientesE1, file="Resultados/Nensayo1.rds")
##Guardar esta tabla:
saveRDS(AcuNutrientesE1, file="Resultados/Nensayo1.rds")
AcuNutrientesE2<-data.frame("Fecha"= msensayo2$fecha[msensayo1$fecha>f02],
"Factor"=msensayo2$group[msensayo1$fecha>f02],
"Nivel"=msensayo2$nivel[msensayo1$fecha>f02],
"MS"=msensayo2$media[msensayo1$fecha>f02])
AcuNutrientesE2<-data.frame("Fecha"= msensayo2$fecha[msensayo2$fecha>f02],
"Factor"=msensayo2$group[msensayo2$fecha>f02],
"Nivel"=msensayo2$nivel[msensayo2$fecha>f02],
"MS"=msensayo2$media[msensayo2$fecha>f02])
View(AcuNutrientesE2)
Nutriente2$Medicion<-trimws(Nutriente1$Medicion)
mediciones<-c("PRIMERA", "SEGUNDA", "TERCERA", "CUARTA")
dosis<-c(1:4)
variedad<-c(1:2)
##Crear un vector con concentraciones de Nitrogeno
concNdosis<-c()
indicador<-c()
Nutriente2$Medicion<-trimws(Nutriente2$Medicion)
mediciones<-c("PRIMERA", "SEGUNDA", "TERCERA", "CUARTA")
dosis<-c(1:4)
variedad<-c(1:2)
##Crear un vector con concentraciones de Nitrogeno
concNdosis<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concNdosis<- c(concNdosis, mean(Nutriente2$N.[Nutriente2$Medicion== i &
Nutriente2$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concNdosis<- c(concNdosis, mean(Nutriente2$N.[Nutriente2$Medicion== i &
Nutriente2$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
AcuNutrientesE2$Nx100<-concNdosis
###Lo mismo con Fosforo
concP<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concP<- c(concP, mean(Nutriente2$P.[Nutriente2$Medicion== i &
Nutriente2$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concP<- c(concP, mean(Nutriente2$P.[Nutriente2$Medicion== i &
Nutriente2$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
AcuNutrientesE2$Px100<-concP
##### Ahora el potasio
concK<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concK<- c(concK, mean(Nutriente2$K.[Nutriente2$Medicion== i &
Nutriente2$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concK<- c(concK, mean(Nutriente2$K.[Nutriente2$Medicion== i &
Nutriente2$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
AcuNutrientesE2$Kx100<-concK
#### el Calcio
concCa<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concCa<- c(concCa, mean(Nutriente2$Ca.[Nutriente2$Medicion== i &
Nutriente2$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concCa<- c(concCa, mean(Nutriente2$Ca.[Nutriente2$Medicion== i &
Nutriente2$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
AcuNutrientesE2$Cax100<-concCa
concMg<-c()
indicador<-c()
for (i in mediciones){
for (j in dosis){
concMg<- c(concMg, mean(Nutriente2$Mg.[Nutriente2$Medicion== i &
Nutriente2$dosis== j]))
indicador<-c(indicador, paste(i,j))
}
for (v in variedad){
concMg<- c(concMg, mean(Nutriente2$Mg.[Nutriente2$Medicion== i &
Nutriente2$variedad== v]))
indicador<-c(indicador, paste(i,v))
}
j<-1
v<-1
}
indicador
AcuNutrientesE2$Mgx100<-concMg
AcuNutrientesE2$Nacu<-AcuNutrientesE2$MS*AcuNutrientesE2$Nx100/100
AcuNutrientesE2$Pacu<-AcuNutrientesE2$MS*AcuNutrientesE2$Px100/100
AcuNutrientesE2$Kacu<-AcuNutrientesE2$MS*AcuNutrientesE2$Kx100/100
AcuNutrientesE2$Caacu<-AcuNutrientesE2$MS*AcuNutrientesE2$Cax100/100
AcuNutrientesE2$Mgacu<-AcuNutrientesE2$MS*AcuNutrientesE2$Mgx100/100
##Guardar esta tabla:
saveRDS(AcuNutrientesE2, file="Resultados/Nensayo2.rds")
